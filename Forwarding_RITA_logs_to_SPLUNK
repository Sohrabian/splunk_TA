--------------------------------------------
---------Installation of RITA---------------
--------------------------------------------
## Step 00- Frist Step is Install zeek on the Server via below link:
https://github.com/Sohrabian/splunk_TA/blob/main/Forwarding_zeek_log_to_splunk.txt


--------------------------------------------------------------
--------Downlaod RITA v4.7.0 FOR Ubuntu 20.04 ----------------
--------------------------------------------------------------
Downlaod Link - 
https://github.com/activecm/rita-legacy/releases

Dwonlaod the :
  install.sh
Put it onto the zeek server and then :
  chmod +x install.sh
  or
  chmod 755 install.sh
Install via 
  sudo ./install.sh

--------------------------------------------
-----------Data Rolling via RITA Command----
--------------------------------------------
the Meaning of this Command in RITA using chatGPT:
rita import --rolling --numchunks 48 /opt/zeek/logs/current 48-hour-dataset

01- The command rita import --rolling --numchunks 48 /opt/zeek/logs/current 48-hour-dataset 
is used to import log data into a specified dataset using the Rita tool, which is commonly
associated with analyzing Zeek (formerly known as Bro) logs. Below is a breakdown of the 
command and its components:
Command Breakdown

    rita import: This initiates the import process in Rita, which is designed to handle log data from Zeek.
    --rolling: This flag indicates that the import should be done in a rolling manner, which typically means
                that it will continuously check for new log entries and update the dataset accordingly. 
                This is useful for real-time data analysis.
    --numchunks 48: This option specifies that the import process should be divided into 48 chunks.
                    This can help optimize performance by allowing the system to manage memory and 
                    processing more efficiently, especially when dealing with large datasets.
    /opt/zeek/logs/current: This is the path to the directory containing the current logs generated by Zeek.
                            The logs in this directory are what will be imported into Rita.
    48-hour-dataset: This is the name of the dataset where the imported logs will be stored.
                    It suggests that this dataset will contain information relevant to a 48-hour period.

Usage Context
This command is particularly useful in environments where Zeek is deployed for network monitoring and security analysis.
By importing logs in chunks, users can efficiently manage large volumes of data without overwhelming system resources.
The rolling import feature allows for near real-time updates, making it easier to analyze ongoing network activities and incidents.
In summary, this command facilitates effective log management and analysis by leveraging Rita's capabilities to handle Zeek logs efficiently.

02- 
The command rita import --rolling --numchunks 48 is used within the RITA (Real Intelligence Threat Analytics)
framework to import log data into a rolling dataset that retains the most recent 48 hours of logs.
Hereâ€™s a detailed breakdown of its components and functionality:
Command Breakdown

    rita import: This is the primary command used to import log files into RITA for analysis.
    --rolling: This flag indicates that the dataset being created will be a rolling dataset.
                Rolling datasets allow for continuous analysis of incoming log data over time,
                automatically cycling out older data as new data comes in.
    --numchunks 48: This option specifies the number of chunks to retain in the rolling dataset.
                    Each chunk typically represents one hour of log data, so with 48 chunks,
                    RITA will hold logs for the last 48 hours. When new data is imported, 
                    the oldest chunk will be removed to make space for the new data, 
                    ensuring that only the most recent 48 hours are kept available for analysis1


Usage Scenario
This command is particularly useful in environments
where logs are generated continuously, such as network monitoring setups using Bro/Zeek logs.
By running this command every hour (or at another regular interval),
users can maintain an up-to-date dataset that reflects recent activity without manually managing older logs.

Example Command
To execute this command effectively, you might use:

bash
rita import --rolling --numchunks 48 /opt/bro/logs/current 48-hour-dataset

In this example:

    /opt/bro/logs/current is the directory containing the log files to be imported.
    48-hour-dataset is the name assigned to this rolling dataset.

Benefits of Using Rolling Datasets

    Automated Data Management: Automatically removes older chunks as new data arrives.
    Continuous Monitoring: Keeps recent logs readily available for immediate analysis.
    Flexible Configuration: Users can adjust the number of chunks based on their specific needs and retention policies.

This command is essential for maintaining an efficient and effective threat detection strategy using RITA,
allowing analysts to focus on current threats without being overwhelmed by historical data.

--------------------------------------------
---------Installation of RITA---------------
--------------------------------------------
## Step 01- RITA Installation and Configuration 
rita import --rolling --numchunks 48 /opt/zeek/logs/current 48-hour-dataset

## Step 02- Splunk Integration with RITA 
1- apt-get install sshpass

2- mkdir /opt/csvlogs

3- nano /opt/RITA.sh

#! /bin/bash
rita import --rolling --numchunks 48 /opt/zeek/logs/current 48-hour-dataset 
rita show-beacons 48-hour-dataset > /opt/csvlogs/show-beacons.csv
rita show-beacons-proxy 48-hour-dataset > /opt/csvlogs/show-beacons-proxy.csv 
rita show-bl-dest-ips 48-hour-dataset > /opt/csvlogs/show-bl-dest-ips.csv 
rita show-bl-source-ips 48-hour-dataset > /opt/csvlogs/show-bl-source-ips.csv 
rita show-exploded-dns 48-hour-dataset > /opt/csvlogs/show-exploded-dns.csv 
rita show-open-connections 48-hour-dataset > /opt/csvlogs/show-open-connections.csv  
rita show-useragents 48-hour-dataset > /opt/csvlogs/show-useragents.csv  
rita show-beacons-sni 48-hour-dataset > /opt/csvlogs/show-beacons-sni.csv  
rita show-bl-hostnames 48-hour-dataset > /opt/csvlogs/show-bl-hostnames.csv  
rita show-long-connections 48-hour-dataset > /opt/csvlogs/show-long-connections.csv  
rita show-strobes 48-hour-dataset > /opt/csvlogs/show-strobes.csv  

sshpass -p 123456@a scp -r /opt/csvlogs/* root@10.1.1.1:/opt/splunk/etc/apps/search/lookups

4- chmod 755 /opt/RITA.sh

5- nano /etc/crontab

*/1 * * * * root /opt/RITA.sh

OR

0 * * * * root /opt/RITA.sh


6- service cron restart

## Step 03- Beaconing Detection with RITA and SPLUNK
| inputlookup show-beacons.csv
| table "Score","Source IP","Destination IP","Connections","Avg. Bytes","Total Bytes","TS Score","DS Score","Dur Score","Hist Score","Top Intvl"
